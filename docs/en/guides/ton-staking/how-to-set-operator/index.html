<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>How to Set Operator · Tokamak Network Documents</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="The document includes the process of registering the operator on a staking dashboard, starting with the deployment of smart contracts needed to operate the operator."/><meta name="docsearch:language" content="en"/><meta property="og:title" content="How to Set Operator · Tokamak Network Documents"/><meta property="og:type" content="website"/><meta property="og:url" content="https://onther-tech.github.io/"/><meta property="og:description" content="The document includes the process of registering the operator on a staking dashboard, starting with the deployment of smart contracts needed to operate the operator."/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/tokamak_favicon.svg"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/prism.css"/><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/en"><img class="logo" src="/img/tokamak_white.png" alt="Tokamak Network Documents"/></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/docs/en/learn/basic/tokamak-network" target="_self">Docs</a></li><li class=""><a href="/docs/en/guides/optimism/how-to-build-new-optimism-layer2" target="_self">Getting Started</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/img/language.svg" alt="Languages icon"/>English</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/ko/guides/ton-staking/how-to-set-operator">한국어</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/onther-tech/docs.tokamak.network/edit/master/docs/guides/ton-staking/how-to-set-operator.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">How to Set Operator</h1></header><article><div><span><p>The document includes the process of registering the operator on a staking dashboard, starting with the deployment of smart contracts needed to operate the operator.</p>
<blockquote>
<p>Because it consumes a significant amount of ETH when steaming directly, it is recommended to use the <code>delegate</code> on the <a href="https://staking.tokamak.network">Dashboard</a> unless it is intended for special purposes.</p>
</blockquote>
<p>Contracts that need to be deployed to set up operators are <code>SubmitHandler</code>, <code>EpochHandler</code>, and <code>Layer 2</code> contracts.
The ETH required for the deployment of the corresponding contract is consumed by about 0.1 ETH on a gas price basis of 10 gwei.</p>
<p>The guide was performed on Mac OS and Linux 16.04.</p>
<h2><a class="anchor" aria-hidden="true" id="set-operator"></a><a href="#set-operator" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Set Operator</h2>
<h3><a class="anchor" aria-hidden="true" id="ton-contract-information"></a><a href="#ton-contract-information" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>TON Contract Information</h3>
<p>'TON' token and steak manager contract addresses are as follows.</p>
<p><strong>Contract Information</strong></p>
<pre><code class="hljs">TON: 0x2be5e8c109e2197d077d13a82daead6a9b3433c5
WTON: 0xc4A11aaf6ea915Ed7Ac194161d2fC9384F15bff2 
Layer2Registry: 0x0b3E174A2170083e770D5d4Cf56774D221b7063e
DepositManager: &quot;0x56E465f654393fa48f007Ed7346105c7195CEe43&quot;
SeigManager: &quot;e0x710936500aC59e8551331871Cbad3D33d5e0D909&quot;
PowerTON: &quot;0xd86d8950A4144D8a258930F6DD5f90CCE249E1CF&quot;
</code></pre>
<p>It can be checked through <a href="https://dashboard-api.tokamak.network/managers">Dashboard API</a>.</p>
<h3><a class="anchor" aria-hidden="true" id="download-source-code--package-install"></a><a href="#download-source-code--package-install" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Download Source Code &amp; Package Install</h3>
<pre><code class="hljs css language-bash">$ git <span class="hljs-built_in">clone</span> https://github.com/Onther-Tech/plasma-evm-contracts.git
$ <span class="hljs-built_in">cd</span> plasma-evm-contracts &amp;&amp; npm install
$ git submodule update --init --recursive
</code></pre>
<p>Once the package has been installed, you can proceed to the next step.</p>
<p>The versions of Truffle, Node.js, and Web3.js used in the script are as follows:</p>
<pre><code class="hljs css language-bash">Truffle v5.1.42 (core: 5.1.42)
Solidity - 0.5.12 (solc-js)
Node v13.8.0
Web3.js v1.2.1
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="ethereum-mainnet-access-endpoint"></a><a href="#ethereum-mainnet-access-endpoint" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ethereum Mainnet Access Endpoint</h3>
<p>The Ethereum mainnet access endpoint is required to deploy the operator. Although there are many ways, it is easy to use node addresses provided through 'Infura'. It secures address that can be accessed through 'Infura'.</p>
<p>If you don't have an 'Infura' account, you can get a access endpoint (URL) through [<a href="http://infura.io">infura.io</a>] (<a href="https://infura.io/)">https://infura.io/)</a>) membership.</p>
<p>When joining the site is completed, click <code>CREATE NEW PROJECT</code> of <code>Dashboard</code> to create a project.</p>
<p>Next, <code>ENDPOINTS</code> address that combines <code>PROJECT ID</code> is used as below.</p>
<p><code>https://mainnet.infura.io/v3/[ProjectID]</code></p>
<p><img src="/docs/assets/guides_create-infura-node.png" alt="Infura node ID">
ex) <code>https://mainnet.infura.io/ws/v3/07b1363d79a94e30af61da848ecfa194</code></p>
<p>If you have an Ethereum node that you operate, you can use that node's access address instead of the <code>Infura</code> address.</p>
<h3><a class="anchor" aria-hidden="true" id="deploy-operator"></a><a href="#deploy-operator" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deploy Operator</h3>
<p>Operator deployment is carried out using truffle. If truffle is not installed, install it using npm.</p>
<pre><code class="hljs css language-bash">$ npm install -g truffle
</code></pre>
<p>Once the truffle has been installed, you can now start deploying the operator. The deployment requires the Ethereum mainnet access address mentioned above and the private key of the account to be an operator.</p>
<p>It is recommended that you check the gas price through <a href="https://ethgasstation.info/">Eth Gas Station</a> before contract deployment. Check the gas cost and adjust the gas cost in <code>truffle-config.js</code>.</p>
<pre><code class="hljs css language-javascript"><span class="hljs-number">46</span>  mainnet: {
<span class="hljs-number">47</span>    provider: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">new</span> PrivateKeyProvider(process.env.MAINNET_PRIVATE_KEY, process.env.MAINNET_PROVIDER_URL),
<span class="hljs-number">48</span>    network_id: <span class="hljs-number">1</span>, <span class="hljs-comment">// eslint-disable-line camelcase</span>
<span class="hljs-number">49</span>    gasPrice: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">adjust</span> <span class="hljs-attr">gas</span> <span class="hljs-attr">price</span>&gt;</span>,
50    skipDryRun: true,
51  },
</span></code></pre>
<p>If your private key is ready, you can now start deploying it.
Contract deployment order is followed by <code>EpochHandler</code>, <code>SubmitHandler</code>, and <code>Layer 2</code>.</p>
<p>First of all, it is going to deploy <code>EpochHandler</code> contract.</p>
<pre><code class="hljs css language-bash">plasam-evm-contracts $ MAINNET_PRIVATE_KEY=&lt;operator<span class="hljs-string">'s private key&gt; \        
                       MAINNET_PROVIDER_URL=https://mainnet.infura.io/v3/&lt;use-your-own-infura-project-id&gt; \
                       SET_OPERATOR=true epoch=true truffle migrate --network mainnet
</span></code></pre>
<p>Next, it is going to deploy <code>SubmitHandler</code> contract.</p>
<pre><code class="hljs css language-bash">plasam-evm-contracts $ MAINNET_PRIVATE_KEY=&lt;operator<span class="hljs-string">'s private key&gt; \        
                       MAINNET_PROVIDER_URL=https://mainnet.infura.io/v3/&lt;use-your-own-infura-project-id&gt; \
                       SET_OPERATOR=true submit=true truffle migrate --network mainnet
</span></code></pre>
<p>The last turn is deploy <code>Layer2</code> contract.</p>
<pre><code class="hljs css language-bash">plasam-evm-contracts $ MAINNET_PRIVATE_KEY=&lt;operator<span class="hljs-string">'s private key&gt; \        
                       MAINNET_PROVIDER_URL=https://mainnet.infura.io/v3/&lt;use-your-own-infura-project-id&gt; \
                       SET_OPERATOR=true l2=true truffle migrate --network mainnet
</span></code></pre>
<p>Address of <code>EpochHandler</code> contract is required for deployment of 'SubmitHandler' contract, address of <code>SubmitHandler</code> and <code>EpochHandler</code> contract is required for deployment of <code>Layer2</code> contract, and contract addresses are stored in <code>l2.json</code> file for deployment of each contract. If an error occurs during contract deployment, there may be a problem that all contents of <code>l2.json</code> disappear. If so, you can check the contract address that is printed during deployment and input it into <code>l2.json</code> in the following format.</p>
<pre><code class="hljs css language-json">{<span class="hljs-attr">"EpochHandler"</span>:<span class="hljs-string">"0xaeb25ad2512c237820A7d2094194E1e46c279bDf"</span>,<span class="hljs-attr">"SubmitHandler"</span>:<span class="hljs-string">"0xb40faB9d05c9494abefEB502d71482Eb191fc629"</span>,<span class="hljs-attr">"Layer2"</span>:<span class="hljs-string">"0x5564AD50B6Ef6270DDb11bA5030AE86A9D562390"</span>}
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="set-operator-1"></a><a href="#set-operator-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Set Operator</h3>
<p>If contract deployment is successfully finished, you can set <code>Layer2</code> and register to <code>Layer2Registry</code> by using command below.</p>
<pre><code class="hljs css language-bash">plasam-evm-contracts $ MAINNET_PRIVATE_KEY=&lt;operator<span class="hljs-string">'s private key&gt; \        
                       MAINNET_PROVIDER_URL=https://mainnet.infura.io/v3/&lt;use-your-own-infura-project-id&gt; \
                       SET_OPERATOR=true setl2=true truffle migrate --network mainnet
</span></code></pre>
<p>To execute these two commands, <code>Layer2</code>, <code>SeigManager</code>, and <code>Layer2Registry</code> contract addresses are needed. Before performing this, check <code>l2.json</code> and <code>deployed.json</code> to make sure that both contract addresses are entered correctly. <code>Layer2</code> contract address is the contract address deployed at the above stage. The contract address for <code>SeigManager</code> contract address is <code>0x710936500aC59e8551331871Cbad3D33d5e0D909</code>, <code>Layer2Registry</code> contract address is <code>0x0b3E174A2170083e770D5d4Cf56774D221b7063e</code>.</p>
<h2><a class="anchor" aria-hidden="true" id="registry-operator"></a><a href="#registry-operator" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Registry Operator</h2>
<p>The last step in registering an operator is to register with a dashboard.</p>
<p>Some parameters are required to register with the dashboard and are as follows:</p>
<pre><code class="hljs css language-bash">operator_name: operator<span class="hljs-string">'s name
chainid: chain id, It must not be duplicated
website: operator'</span>s website address
description: description about operator
layer2: deployed layer2 contract address
</code></pre>
<p>The commands for registering an operator are as follows.</p>
<pre><code class="hljs css language-bash">plasma-evm-contracts $ chainid=&lt;operator<span class="hljs-string">'s chain id&gt; \
                       layer2=&lt;layer2-contract-address&gt; \
                       website="&lt;website address&gt;" \
                       description="&lt;description about operator&gt;" \
                       operator_name="&lt;operator'</span>s name&gt;<span class="hljs-string">" \
                       node register.js
</span></code></pre>
<p>If <code>chain id</code> is duplicated, there will be an error called <code>duplicate chain id</code>. In that case, change <code>chain id</code> and register again.</p>
<p>If all of the process are sucessfully finished, you can check your operator in the <a href="https://staking.tokamak.network">Staking Dahsboard</a>.</p>
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#set-operator">Set Operator</a><ul class="toc-headings"><li><a href="#ton-contract-information">TON Contract Information</a></li><li><a href="#download-source-code--package-install">Download Source Code &amp; Package Install</a></li><li><a href="#ethereum-mainnet-access-endpoint">Ethereum Mainnet Access Endpoint</a></li><li><a href="#deploy-operator">Deploy Operator</a></li><li><a href="#set-operator-1">Set Operator</a></li></ul></li><li><a href="#registry-operator">Registry Operator</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"></a><div><h5>Docs</h5><a href="/docs/en/learn/basic/tokamak-network">Learn</a><a href="/docs/en/guides/getting-started/how-to-open-private-testnet-rootchain">Guides</a></div><div><h5>Community</h5><a href="https://discord.gg/8wSpJKz">Discord</a><a href="https://t.me/tokamak_network">Telegram</a><a href="https://twitter.com/ontherinfo">Twitter</a><a href="https://www.facebook.com/OntherInc">Facebook</a></div><div><h5>More</h5><a href="http://blog.onther.io">Onther Blog</a><a href="https://github.com/onther-tech/">Onther GitHub</a></div><div><h5>Family site</h5><a href="https://tokamak.network">Tokamak Network</a><a href="https://staking.tokamak.network">Original Staking</a><a href="https://simple.staking.tokamak.network">Simple Staking</a><a href="https://staking-simulator.tokamak.network">Staking Simulator</a><a href="https://price.tokamak.network">Price Dashboard</a><a href="https://vesting.tokamak.network">Vesting Dashboard</a><a href="https://wton-swapper.tokamak.network">TON-WTON Swapper</a></div></section><a href="https://tokamak.network" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/img/tokamak_white.png" alt="Tokamak Network" width="200%" height="200%"/></a><section class="copyright">Copyright © 2021 Onther Inc.</section></footer></div></body></html>