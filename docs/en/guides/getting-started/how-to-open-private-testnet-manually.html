<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Setup Childchain in Private Testnet · Tokamak Network Documents</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="## Intro"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Setup Childchain in Private Testnet · Tokamak Network Documents"/><meta property="og:type" content="website"/><meta property="og:url" content="https://onther-tech.github.io/"/><meta property="og:description" content="## Intro"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/tokamak_favicon.svg"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/prism.css"/><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/en"><img class="logo" src="/img/tokamak_white.png" alt="Tokamak Network Documents"/></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/docs/en/learn/basic/tokamak-network" target="_self">Docs</a></li><li class=""><a href="/docs/en/guides/optimism/how-to-build-new-optimism-layer2" target="_self">Getting Started</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/img/language.svg" alt="Languages icon"/>English</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/ko/guides/getting-started/how-to-open-private-testnet-manually">한국어</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/onther-tech/docs.tokamak.network/edit/master/docs/guides/getting-started/how-to-open-private-testnet-manually.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Setup Childchain in Private Testnet</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" id="intro"></a><a href="#intro" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Intro</h2>
<p>If you successfully deployed rootchain with <a href="how-to-open-private-testnet-rootchain">Setup Rootchain</a>, let's run childchain at this time.
The childchain is layer-2 blockchain of Tokamak which depends on rootchain. In this section, assumed that you had <a href="how-to-open-private-testnet-rootchain">Setup Rootchain</a> with in the same machine.</p>
<h2><a class="anchor" aria-hidden="true" id="setup-operator-node"></a><a href="#setup-operator-node" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Setup Operator Node</h2>
<p>Make sure that you did <a href="how-to-open-private-testnet-rootchain#Setup-rootchain">setup Rootchain</a>.</p>
<blockquote>
<p>Operator and challenger account to be used in root chain must have enough ether balance.
Note that operator node will run successfully only when challenger account has at least 0.5 ETH.</p>
</blockquote>
<h3><a class="anchor" aria-hidden="true" id="1-deploy-rootchain-contract"></a><a href="#1-deploy-rootchain-contract" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. Deploy rootchain contract</h3>
<p>This section explains about <code>deploy</code> command and its parameters for deploying rootChain contract.</p>
<p><code>deploy</code> command has 4 input parameters, <code>&lt;name of genesis file&gt;</code>, <code>&lt;CHAINID&gt;</code>, <code>&lt;PRE-ASSET&gt;</code>, <code>&lt;EPOCH&gt;</code>.</p>
<ul>
<li><code>CHAINID</code> : Chain id set by opertaor.</li>
<li><code>PRE-ASSET</code> : Flag to allocate PETH to accounts in child chain at genesis or not.</li>
<li><code>EPOCH</code> : Length of epoch. If <code>EPOCH</code> is <code>2</code>, childchain will submit epoch every 2 blocks.</li>
</ul>
<p>Tokamak Plasma's childchain provides <code>Stamina</code>, a fee payment method for childchain. For more details refer to <a href="https://docs.tokamak.network/docs/en/learn/economics/tx-fee#stamina"><code>Stamina</code></a>.</p>
<p>You can change stamina parameters by adding flags as follows. If not using stamina flag, set default parameters.</p>
<ul>
<li><code>--stamina.operatoramount</code> : Operator stamina amount at genesis block in ETH (default: 1)</li>
<li><code>--stamina.mindeposit</code> : Minimum deposit amount in ETH (default: 0.5)</li>
<li><code>--stamina.recoverepochlength</code> : The length of recovery epoch in block (default: 120960)</li>
<li><code>--stamina.withdrawaldelay</code> : Withdrawal delay in block (default: 362880)</li>
</ul>
<blockquote>
<p>In the case of <code>stamina.withdrawaldelay</code>, a value of at least two times more than <code>stamina.recoverepochlength</code> should be used.</p>
</blockquote>
<p>The stamina feature is provided as a pre-compiled contract in childchain. The stamina contract address is <code>0x000000000000000000000000000000000000dead</code> in every tokamak plasma childchain.</p>
<p>You can check <a href="https://github.com/Onther-Tech/stamina">this</a> for more details about the stamina contract.</p>
<p>Create <code>deploy.operator1.sh</code> by running following command.</p>
<pre><code class="hljs css language-bash">plasma-evm$ cat &gt; deploy.operator1.sh &lt;&lt; <span class="hljs-string">"EOF"</span>
<span class="hljs-meta">#!/bin/bash</span>
OPERATOR_KEY=<span class="hljs-string">"86e60281da515184c825c3f46c7ec490b075af1e74607e2e9a66e3df0fa22122"</span>
OPERATOR=<span class="hljs-string">"0x5e3230019fed7ab462e3ac277e7709b9b2716b4f"</span>

DATADIR=.pls.staking/operator1

ROOTCHAIN_IP=127.0.0.1

<span class="hljs-comment"># Deploy contracts at rootchain</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Deploy rootchain contract and others"</span>
make geth &amp;&amp; build/bin/geth \
    --nousb \
    --datadir <span class="hljs-variable">$DATADIR</span> \
    --rootchain.url <span class="hljs-string">"ws://<span class="hljs-variable">$ROOTCHAIN_IP</span>:8546"</span> \
    --unlock <span class="hljs-variable">$OPERATOR</span> \
    --password pwd.pass \
    --rootchain.sender <span class="hljs-variable">$OPERATOR</span> \
    --stamina.operatoramount 1 \
    --stamina.mindeposit 0.5 \
    --stamina.recoverepochlength 120960 \
    --stamina.withdrawaldelay 362880 \
    deploy <span class="hljs-string">"./genesis-operator1.json"</span> 102 <span class="hljs-literal">true</span> 2

<span class="hljs-comment"># you can checkout "$geth deploy --help" for more information</span>
EOF
</code></pre>
<p>You can run <code>deploy.operator1.sh</code> script as following command.</p>
<pre><code class="hljs css language-sh">plasma-evm$ bash deploy.operator1.sh
</code></pre>
<p><code>genesis-operator1.json</code> gerenated from the script will be located in <code>plasma-evm</code> directory.</p>
<h3><a class="anchor" aria-hidden="true" id="2-initialize"></a><a href="#2-initialize" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. Initialize</h3>
<p>You must initialize chain data before running operator node.</p>
<p><code>genesis-operator1.json</code> is located in current path(i.e <code>~/plasma-evm/genesis-operator1.json</code>).</p>
<p>Run following command to initialize chain data.</p>
<pre><code class="hljs css language-bash">plasma-evm$ build/bin/geth --nousb init \
            --datadir .pls.staking/operator1 \
            --rootchain.url ws://localhost:8546 \
            genesis-operator1.json
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="3-set-manager-contract"></a><a href="#3-set-manager-contract" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. Set manager contract</h3>
<p>After <a href="#2-initialize">2. Initialize</a> for childchain, The Operator should register an address of the rootchain contract to stake manager contract.</p>
<p>After setting up the operator plasma chain, operator must register a rootchain contract address to the stake manager contract.</p>
<p>Using <code>setManagers</code> sub-command of <code>manage-staking</code>, set the stake contract addresses to run operator's plasma chain.</p>
<pre><code class="hljs css language-bash">plasma-evm $ build/bin/geth --nousb manage-staking setManagers manager.json  \
            --datadir ./.pls.staking/operator1
INFO [01-01|00:00:00.000] Maximum peer count                       ETH=50 LES=0 total=50
INFO [01-01|00:00:00.000] Set options <span class="hljs-keyword">for</span> submitting a block       mingaspirce=1000000000 maxgasprice=100000000000 resubmit=0s
INFO [01-01|00:00:00.000] Allocated cache and file handles         database=/home/ubuntu/plasma-evm/.pls.staking/operator1/geth/stakingdata cache=16.00MiB handles=16
INFO [01-01|00:00:00.000] Set address                              name=TON addr=0x3A220f351252089D385b29beca14e27F204c296A
INFO [01-01|00:00:00.000] Set address                              name=WTON addr=0xdB7d6AB1f17c6b31909aE466702703dAEf9269Cf
INFO [01-01|00:00:00.000] Set address                              name=DepositManager addr=0x880EC53Af800b5Cd051531672EF4fc4De233bD5d
INFO [01-01|00:00:00.000] Set address                              name=RootChainRegistry addr=0x537e697c7AB75A26f9ECF0Ce810e3154dFcaaf44
INFO [01-01|00:00:00.000] Set address                              name=SeigManager       addr=0x3Dc2cd8F2E345951508427872d8ac9f635fBe0EC
INFO [01-01|00:00:00.000] Set address                              name=PowerTON          addr=0xBcDfc870Ea0C6463C6EBb2B2217a4b32B93BCFB7
</code></pre>
<p>Check if the information of stake contract address is included in the operator chaindata with <code>getManagers</code> sub-command of <code>manage-staking</code>.</p>
<pre><code class="hljs css language-bash">plasma-evm $ build/bin/geth --nousb \
              manage-staking getManagers \
              --datadir ./.pls.staking/operator1
INFO [01-01|00:00:00.000] Maximum peer count                       ETH=50 LES=0 total=50
INFO [01-01|00:00:00.000] Smartcard socket not found, disabling    err=<span class="hljs-string">"stat /run/pcscd/pcscd.comm: no such file or directory"</span>
INFO [01-01|00:00:00.000] Set options <span class="hljs-keyword">for</span> submitting a block       mingaspirce=1000000000 maxgasprice=100000000000 resubmit=0s
INFO [01-01|00:00:00.000] Allocated cache and file handles         database=/home/ubuntu/plasma-evm/.pls.staking/manager/geth/stakingdata cache=16.00MiB handles=16
{
  <span class="hljs-string">"TON"</span>: <span class="hljs-string">"0x3a220f351252089d385b29beca14e27f204c296a"</span>,
  <span class="hljs-string">"WTON"</span>: <span class="hljs-string">"0xdb7d6ab1f17c6b31909ae466702703daef9269cf"</span>,
  <span class="hljs-string">"DepositManager"</span>: <span class="hljs-string">"0x880ec53af800b5cd051531672ef4fc4de233bd5d"</span>,
  <span class="hljs-string">"RootChainRegistry"</span>: <span class="hljs-string">"0x537e697c7ab75a26f9ecf0ce810e3154dfcaaf44"</span>,
  <span class="hljs-string">"SeigManager"</span>: <span class="hljs-string">"0x3dc2cd8f2e345951508427872d8ac9f635fbe0ec"</span>,
  <span class="hljs-string">"PowerTON"</span>: <span class="hljs-string">"0x82567a6f6e3abe246f62350322a07af7f413cfe6"</span>
}
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="4-register-rootchain-contract"></a><a href="#4-register-rootchain-contract" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. Register rootchain contract</h3>
<p>Register the rootchain address of operator plasma chain to the stake manager contract in order to receive seigniorage.</p>
<pre><code class="hljs css language-bash">plasma-evm $ build/bin/geth --nousb manage-staking register \
            --datadir ./.pls.staking/operator1 \
            --rootchain.url ws://127.0.0.1:8546 \
            --unlock 0x5e3230019fed7ab462e3ac277e7709b9b2716b4f \
            --password pwd.pass \
            --rootchain.sender 0x5e3230019fed7ab462e3ac277e7709b9b2716b4f
</code></pre>
<p>If rootchain address is successfully registered, you will see the following message.</p>
<pre><code class="hljs css language-bash">INFO [01-01|00:00:00.000] Maximum peer count                       ETH=50 LES=0 total=50
INFO [01-01|00:00:00.000] Operator account is unlocked             address=0x5E3230019fEd7aB462e3AC277E7709B9b2716b4F
INFO [01-01|00:00:00.000] Set options <span class="hljs-keyword">for</span> submitting a block       mingaspirce=1000000000 maxgasprice=100000000000 resubmit=0s
INFO [01-01|00:00:00.000] Allocated cache and file handles         database=/home/ubuntu/plasma-evm/.pls.staking/operator1/geth/stakingdata cache=16.00MiB handles=16
INFO [01-01|00:00:00.000] Using manager contracts                  TON=0x3A220f351252089D385b29beca14e27F204c296A WTON=0xdB7d6AB1f17c6b31909aE466702703dAEf9269Cf DepositManager=0x880EC53Af800b5Cd051531672EF4fc4De233bD5d RootChainRegistry=0x537e697c7AB75A26f9ECF0Ce810e3154dFcaaf44 SeigManager=0x3Dc2cd8F2E345951508427872d8ac9f635fBe0EC
INFO [01-01|00:00:00.000] Registered SeigManager to RootChain      registry=0x537e697c7AB75A26f9ECF0Ce810e3154dFcaaf44 rootchain=0x17FB80e2E16b02faC936933424305d4F29F9d5D9 seigManager=0x3Dc2cd8F2E345951508427872d8ac9f635fBe0EC tx=b546d3…fe55ed
INFO [01-01|00:00:00.000] Registered RootChain to SeigManager      registry=0x537e697c7AB75A26f9ECF0Ce810e3154dFcaaf44 rootchain=0x17FB80e2E16b02faC936933424305d4F29F9d5D9 seigManager=0x3Dc2cd8F2E345951508427872d8ac9f635fBe0EC tx=6904c9…bc07a5
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="5-run-operator-node"></a><a href="#5-run-operator-node" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. Run Operator node</h3>
<p>Run operator node with following command.</p>
<pre><code class="hljs css language-bash">plasma-evm$ build/bin/geth \
    --nousb \
    --datadir ./.pls.staking/operator1 \
    --syncmode=<span class="hljs-string">'full'</span> \
    --networkid 102 \
    --rootchain.url ws://127.0.0.1:8546 \
    --operator 0x5e3230019fed7ab462e3ac277e7709b9b2716b4f \
    --port 30306 \
    --nat extip:::1 \
    --maxpeers 50 \
    --unlock 0x5e3230019fed7ab462e3ac277e7709b9b2716b4f \
    --password pwd.pass \
    --nodekeyhex e854e2f029be6364f0f961bd7571fd4431f99355b51ab79d23c56506f5f1a7c3 \
    --mine \
    --miner.gastarget 7500000 \
    --miner.gaslimit 10000000
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="setup-user-node"></a><a href="#setup-user-node" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Setup User Node</h2>
<p>This guide describes how to run user node without setting challenger account.</p>
<blockquote>
<p>You can add challenger flag to run challneger node. Note that account balance of challenger must be more than 0.5ETH.</p>
</blockquote>
<h3><a class="anchor" aria-hidden="true" id="1-initialize"></a><a href="#1-initialize" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. Initialize</h3>
<p>Insert URL of RootChain on which <code>RootChain Contract</code> was deployed, as parameter of <code>--rootchain.url</code> flag.</p>
<p>Use the address of RootChain set in <a href="how-to-open-private-testnet-rootchain#setup-rootchain">here</a> as <code>--rootchain.url</code>.</p>
<pre><code class="hljs css language-bash">plasma-evm$ build/bin/geth --nousb init \
            --datadir ./.pls.staking/usernode \
            --rootchain.url ws://localhost:8546 \
            genesis-operator1.json
</code></pre>
<blockquote>
<p>Use same <code>genesis-operator1.json</code> file as in <a href="how-to-open-private-testnet-manually#2-initialize">Setup Operator Node - 2. Initialize</a>.</p>
</blockquote>
<h3><a class="anchor" aria-hidden="true" id="2-running-user-node"></a><a href="#2-running-user-node" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. Running User Node</h3>
<p>You must <a href="how-to-open-private-testnet-rootchain#1-initialize">Setup User Node - 1. Initialize</a> before running user node. It will use same <code>datadir</code> as in the initialization.</p>
<p>Run user node with following command. If you want to run challenger, add <code>--rootchain.challenger 0x0...</code> to the command.</p>
<pre><code class="hljs css language-bash">plasma-evm$ build/bin/geth \
    --nousb \
    --datadir ./.pls.staking/usernode \
    --syncmode=<span class="hljs-string">'full'</span> \
    --networkid 102 \
    --rootchain.url ws://localhost:8546 \
    --rpc \
    --rpcaddr <span class="hljs-string">'0.0.0.0'</span> \
    --rpcport 8547 \
    --rpcapi eth,net,debug \
    --rpccorsdomain <span class="hljs-string">'*'</span> \
    --rpcvhosts=localhost \
    --ws \
    --wsorigins <span class="hljs-string">'*'</span> \
    --wsaddr <span class="hljs-string">'0.0.0.0'</span> \
    --wsport 8548 \
    --bootnodes <span class="hljs-string">"enode://4966a7e4621c2c0b1b1b3295b4a35ccc4224ba1d529bf5aa2323e4650f6075bd5eb6618372b2579965819347307f1f97315ce91b09ca342d60c2e98ad88db9f3@127.0.0.1:30306"</span> \
    --port 30307 \
    --nat extip:::1 \
    --maxpeers 50
</code></pre>
<blockquote>
<p>You must set <code>syncmode</code> to <code>full</code> or <code>archive</code> in order to synchronize with operator node.</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="next"></a><a href="#next" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Next</h2>
<p>Try to send a simple transaction using JSON-RPC protocol to the usernode which setup in the previous step. If no transaction, The childchain, tokamak plasma, does not generate block due to <a href="https://docs.tokamak.network/docs/en/learn/advanced/plasma-evm-architecture">Unique structure of the Tokamak network</a></p>
<p>Also, try to deploy <a href="https://docs.tokamak.network/docs/en/learn/advanced/examples-and-best-practices#requestablesimpletoken">requestable contract</a> to both the rootchain and the childchain, and send some transaction with <a href="https://docs.tokamak.network/docs/en/learn/basic/enter-and-exit">Enter and Exit</a>. these process will help to understand a powerful interoperability of Tokamak network.</p>
<!--## Architecture Diagram ![Architecture after setup childchain](/docs/assets/guides_private_testnet_manually.png)--></span></div></article></div><div class="docLastUpdate"><em>Last updated on 4/16/2020 by Jin</em></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#intro">Intro</a></li><li><a href="#setup-operator-node">Setup Operator Node</a><ul class="toc-headings"><li><a href="#1-deploy-rootchain-contract">1. Deploy rootchain contract</a></li><li><a href="#2-initialize">2. Initialize</a></li><li><a href="#3-set-manager-contract">3. Set manager contract</a></li><li><a href="#4-register-rootchain-contract">4. Register rootchain contract</a></li><li><a href="#5-run-operator-node">5. Run Operator node</a></li></ul></li><li><a href="#setup-user-node">Setup User Node</a><ul class="toc-headings"><li><a href="#1-initialize">1. Initialize</a></li><li><a href="#2-running-user-node">2. Running User Node</a></li></ul></li><li><a href="#next">Next</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"></a><div><h5>Docs</h5><a href="/docs/en/learn/basic/tokamak-network">Learn</a><a href="/docs/en/guides/optimism/how-to-build-new-optimism-layer2">Guides</a></div><div><h5>Community</h5><a href="https://discord.gg/8wSpJKz">Discord</a><a href="https://t.me/tokamak_network">Telegram</a><a href="https://twitter.com/ontherinfo">Twitter</a><a href="https://www.facebook.com/OntherInc">Facebook</a></div><div><h5>More</h5><a href="http://blog.onther.io">Onther Blog</a><a href="https://github.com/onther-tech/">Onther GitHub</a></div><div><h5>Family site</h5><a href="https://tokamak.network">Tokamak Network</a><a href="https://staking.tokamak.network">Original Staking</a><a href="https://simple.staking.tokamak.network">Simple Staking</a><a href="https://staking-simulator.tokamak.network">Staking Simulator</a><a href="https://price.tokamak.network">Price Dashboard</a><a href="https://vesting.tokamak.network">Vesting Dashboard</a><a href="https://wton-swapper.tokamak.network">TON-WTON Swapper</a></div></section><a href="https://tokamak.network" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/img/tokamak_white.png" alt="Tokamak Network" width="200%" height="200%"/></a><section class="copyright">Copyright © 2021 Onther Inc.</section></footer></div></body></html>