<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Puppeth 사용하여 프라이빗 테스트넷 설정 · Tokamak Network Documents</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="이 가이드는 `Puppeth`를 사용하여 프라이빗 루트체인에 연결된 토카막 자식체인을 배포하는 과정을 다룬다."/><meta name="docsearch:language" content="ko"/><meta property="og:title" content="Puppeth 사용하여 프라이빗 테스트넷 설정 · Tokamak Network Documents"/><meta property="og:type" content="website"/><meta property="og:url" content="https://onther-tech.github.io/"/><meta property="og:description" content="이 가이드는 `Puppeth`를 사용하여 프라이빗 루트체인에 연결된 토카막 자식체인을 배포하는 과정을 다룬다."/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/tokamak_favicon.svg"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/prism.css"/><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/ko"><img class="logo" src="/img/tokamak_white.png" alt="Tokamak Network Documents"/></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/ko/learn/basic/tokamak-network" target="_self">Docs</a></li><li class="siteNavGroupActive"><a href="/docs/ko/guides/getting-started/how-to-open-private-testnet-rootchain" target="_self">Getting Started</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/img/language.svg" alt="Languages icon"/>한국어</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/en/guides/getting-started/how-to-open-private-testnet-puppeth">English</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>프라이빗 테스트넷 시작</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">배우기<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">기초</h4><ul><li class="navListItem"><a class="navItem" href="/docs/ko/learn/basic/tokamak-network">토카막 네트워크</a></li><li class="navListItem"><a class="navItem" href="/docs/ko/learn/basic/enter-and-exit">상호운용성: 진입 &amp; 퇴장</a></li><li class="navListItem"><a class="navItem" href="/docs/ko/learn/basic/transaction-fee">편의성: 계정, 트랜잭션 수수료, 개발도구</a></li><li class="navListItem"><a class="navItem" href="/docs/ko/learn/basic/layer-2-solutions">비교: 다른 확장성 솔루션</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">고급</h4><ul><li class="navListItem"><a class="navItem" href="/docs/ko/learn/advanced/design-rationale">디자인 원칙</a></li><li class="navListItem"><a class="navItem" href="/docs/ko/learn/advanced/plasma-evm-architecture">Plasma EVM 아키텍처</a></li><li class="navListItem"><a class="navItem" href="/docs/ko/learn/advanced/root-chain">루트체인</a></li><li class="navListItem"><a class="navItem" href="/docs/ko/learn/advanced/child-chain">자식체인</a></li><li class="navListItem"><a class="navItem" href="/docs/ko/learn/advanced/continuous-rebase">Continuous Rebase</a></li><li class="navListItem"><a class="navItem" href="/docs/ko/learn/advanced/plasma-evm-smart-contracts">Plasma EVM 스마트 컨트랙트</a></li><li class="navListItem"><a class="navItem" href="/docs/ko/learn/advanced/examples-and-best-practices">요청 가능한 컨트랙트 예제</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">토큰경제</h4><ul><li class="navListItem"><a class="navItem" href="/docs/ko/learn/economics/ton">TON</a></li><li class="navListItem"><a class="navItem" href="/docs/ko/learn/economics/child-chain">자식체인과 스테이킹</a></li><li class="navListItem"><a class="navItem" href="/docs/ko/learn/economics/token-supply">토큰 공급과 분배</a></li><li class="navListItem"><a class="navItem" href="/docs/ko/learn/economics/powerton">파워톤</a></li><li class="navListItem"><a class="navItem" href="/docs/ko/learn/economics/tx-fee">트랜잭션 수수료 정책</a></li><li class="navListItem"><a class="navItem" href="/docs/ko/learn/economics/challenge">챌린지</a></li><li class="navListItem"><a class="navItem" href="/docs/ko/learn/economics/glossary">파라미터 정리</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">가이드<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">프라이빗 테스트넷 시작</h4><ul><li class="navListItem"><a class="navItem" href="/docs/ko/guides/getting-started/how-to-open-private-testnet-rootchain">루트체인 설정</a></li><li class="navListItem"><a class="navItem" href="/docs/ko/guides/getting-started/how-to-open-private-testnet-manually">자식체인 설정</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/ko/guides/getting-started/how-to-open-private-testnet-puppeth">Puppeth 사용하여 부모-자식체인 설정</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">퍼블릭 테스트넷 연결</h4><ul><li class="navListItem"><a class="navItem" href="/docs/ko/guides/getting-started/how-to-connect-public-testnet-prepare">연결 준비</a></li><li class="navListItem"><a class="navItem" href="/docs/ko/guides/getting-started/how-to-connect-public-testnet-manually">직접 연결</a></li><li class="navListItem"><a class="navItem" href="/docs/ko/guides/getting-started/how-to-connect-public-testnet-puppeth">Puppeth 사용하여 연결</a></li><li class="navListItem"><a class="navItem" href="/docs/ko/guides/public-testnets">퍼블릭 테스트넷 정보</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">TON 스테이킹</h4><ul><li class="navListItem"><a class="navItem" href="/docs/ko/guides/getting-started/private-testnet-staking">프라이빗 네트워크 테스트</a></li></ul></div></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/onther-tech/docs.tokamak.network/edit/master/docs/guides/getting-started/how-to-open-private-testnet-puppeth.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Puppeth 사용하여 프라이빗 테스트넷 설정</h1></header><article><div><span><p>이 가이드는 <code>Puppeth</code>를 사용하여 프라이빗 루트체인에 연결된 토카막 자식체인을 배포하는 과정을 다룬다.</p>
<p><code>Puppeth</code>란 이더리움 노드 배포를 쉽게 할 수 있는 유틸리티 프로그램이다. <code>plasma-evm</code>의 <code>Puppeth</code>는 토카막 노드를 쉽게 구성 할 수 있도록 추가된 기능이 탑재 되어 있다. <code>Puppeth</code>를 사용하여 자식 체인을 설정하려면 이미 구동중인 루트체인이 필요하다. 테스트로 사용할 루트체인이 필요하다면 <a href="how-to-open-private-testnet-rootchain#%EB%B6%80%EB%AA%A8-%EC%B2%B4%EC%9D%B8-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0">루트체인 설정</a>를 먼저 진행한다.</p>
<p><code>Puppeth</code>에서 사용되는 용어를 먼저 정리하면 아래와 같다.</p>
<ul>
<li><p><code>sealnode</code> : 오퍼레이터 노드, 블록을 생성하는 마이너 노드.</p></li>
<li><p><code>boodnode</code> : 사용자 노드, 트랜잭션을 오퍼레이터 노드에 전달하고 오퍼레이터 노드 동기화.</p></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="puppeth-환경-준비"></a><a href="#puppeth-환경-준비" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>Puppeth</code> 환경 준비</h2>
<blockquote>
<p>루트체인으로 <code>ganache</code> 테스트체인을 사용하는 경우, <code>ganache</code> 실행시 생성된 계정을 오퍼레이터와 챌린저로 사용한다.</p>
</blockquote>
<h3><a class="anchor" aria-hidden="true" id="1-네트워크-설정"></a><a href="#1-네트워크-설정" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 네트워크 설정</h3>
<p>사용자노드는 일종의 프록시 노드로서 <code>30306</code>, <code>8547</code>, <code>8548</code> 포트에 대해 외부에서 접속 할 수 있도록 설정해 주어야 한다.</p>
<p>예를들어, AWS EC2 사용한다면 아래와 같이 보안설정을 변경해 주어야 한다.</p>
<p><img src="/docs/assets/guides_private_testnet_network.png" alt="AWS EC2 Instance Network Setting"></p>
<h3><a class="anchor" aria-hidden="true" id="2-docker--docker-compose-설정"></a><a href="#2-docker--docker-compose-설정" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. Docker &amp; Docker compose 설정</h3>
<p><code>Puppeth</code>를 사용하기 위해서는 원격 머신에 <code>Docker</code>와 <code>docker-compose</code>가 설치 되어 있어야 한다.</p>
<p>Ubuntu 18.04 이외에 운영체제별 <code>Docker</code> 설치에 관해서는 <a href="https://docs.docker.com/install/#supported-platforms">외부 문서</a>를 참고한다.</p>
<p>다음은 Ubuntu 18.04 에서 Docker 설치를 위한 명령어이다.</p>
<pre><code class="hljs css language-bash">~$ sudo apt-get remove docker docker-engine docker.io containerd runc -y
~$ sudo apt-get update
~$ sudo apt-get install apt-transport-https ca-certificates curl gnupg-agent software-properties-common -y
~$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
~$ sudo add-apt-repository <span class="hljs-string">"deb [arch=amd64] https://download.docker.com/linux/ubuntu <span class="hljs-variable">$(lsb_release -cs)</span> stable"</span>
~$ sudo apt-get update &amp;&amp; sudo apt-get install docker-ce docker-ce-cli containerd.io docker-compose -y
</code></pre>
<p>아래 명령어를 실행함으로써 <code>Docker</code> 설치가 정상적으로 이루어졌는지 확인한다.</p>
<pre><code class="hljs css language-bash">~$ sudo docker version
Client: Docker Engine - Community
 Version:           19.03.6
 API version:       1.40
 Go version:        go1.12.16
 Git commit:        369ce74a3c
 Built:             Thu Feb 13 01:27:49 2020
 OS/Arch:           linux/amd64
 Experimental:      <span class="hljs-literal">false</span>

Server: Docker Engine - Community
 Engine:
  Version:          19.03.6
  API version:      1.40 (minimum version 1.12)
  Go version:       go1.12.16
  Git commit:       369ce74a3c
  Built:            Thu Feb 13 01:26:21 2020
  OS/Arch:          linux/amd64
  Experimental:     <span class="hljs-literal">false</span>
 containerd:
  Version:          1.2.10
  GitCommit:        b34a5c8af56e510852c35414db4c1f4fa6172339
 runc:
  Version:          1.0.0-rc8+dev
  GitCommit:        3e425f80a8c931f88e6d94a8c831b9d5aa481657
 docker-init:
  Version:          0.18.0
  GitCommit:        fec3683
</code></pre>
<p>AWS EC2의 Ubuntu 18.04 인스턴스를 사용하는 경우, 기본 계정인 <code>ubuntu</code>를 <code>sudo</code> 없이 <code>docker</code> 명령어를 사용할 수 있도록 한다.</p>
<p>아래 명령어를 통해, 반드시 권한 설정을 해준다.</p>
<pre><code class="hljs css language-bash">~$ sudo usermod -aG docker ubuntu
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="3-원격-접속-키파일-등록"></a><a href="#3-원격-접속-키파일-등록" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 원격 접속 키파일 등록</h3>
<p>AWS EC2 와 같은 원격 Ubuntu 환경은 SSH 원격접속에 키파일이 필요하다.</p>
<p><code>Puppeth</code>도 마찬가지로 SSH 원격접속에 키파일이 필요하다, 따라서 원격 환경내에 자신의 키파일을 가지고 있어야 한다.</p>
<p>자신이 등록한 키파일(e.g : <code>key.pem</code>)을 원격 환경에 전송하려면 자신의 로컬환경에서 아래 명령어를 실행한다.</p>
<pre><code class="hljs css language-bash"><span class="hljs-built_in">local</span>-machine ~$ scp -i ~/.ssh/key.pem ~/.ssh/key.pem ubuntu@&lt;Remote Instance IP&gt;:/home/ubuntu/.ssh/id_rsa
</code></pre>
<p>키파일이 정상적으로 복사되었다면 원격 환경에서 localhost SSH 접속이 가능하다.</p>
<p>원격환경 터미널 내에서 아래 명령어를 사용하여 올바른 키파일이 등록되어 있는지 확인한다.</p>
<pre><code class="hljs css language-bash">~$ ssh ubuntu@localhost
Welcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-1057-aws x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Tue Feb 1 00:00:00 UTC 2020

  System load:  0.0               Processes:              108
  Usage of /:   9.2% of 29.02GB   Users logged <span class="hljs-keyword">in</span>:        1
  Memory usage: 25%               IP address <span class="hljs-keyword">for</span> eth0:    172.31.18.103
  Swap usage:   0%                IP address <span class="hljs-keyword">for</span> docker0: 172.17.0.1


54 packages can be updated.
32 updates are security updates.

~$
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="4-소스코드-다운로드-및-컴파일"></a><a href="#4-소스코드-다운로드-및-컴파일" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 소스코드 다운로드 및 컴파일</h3>
<p><a href="https://github.com/onther-tech/plasma-evm">https://github.com/onther-tech/plasma-evm</a> 기준으로 진행된다.</p>
<p>다음 명령어를 통해서 소스코드를 복제하고 <code>plasma-evm</code>을 컴파일을 진행한다.</p>
<pre><code class="hljs css language-bash">~$ git <span class="hljs-built_in">clone</span> https://github.com/onther-tech/plasma-evm
~$ <span class="hljs-built_in">cd</span> plasma-evm &amp;&amp; make all
</code></pre>
<blockquote>
<p><code>make: *** ..</code> 에러 발생의 경우, 빌드환경이 구성되지 않은 상태이므로 <a href="how-to-open-private-testnet-rootchain#%EB%B6%80%EB%AA%A8-%EC%B2%B4%EC%9D%B8-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0">루트체인 설정</a>를 진행한다.</p>
</blockquote>
<p>컴파일을 마치면 <code>puppeth</code> 실행파일이 <code>plasma-evm/build/bin/</code> 에 생성된다.</p>
<h3><a class="anchor" aria-hidden="true" id="5--루트체인-컨트랙트-배포"></a><a href="#5--루트체인-컨트랙트-배포" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5.  루트체인 컨트랙트 배포</h3>
<p><code>Puppeth</code>를 실행하기 전에, 자식체인이 사용할 루트체인 컨트랙트를 배포하고 해당 정보를 담은 <code>genesis</code> 파일을 생성한다. <a href="how-to-open-private-testnet-manually#2-루트체인-컨트랙트-배포">프라이빗 테스트넷 직접 설정 - 2. 루트체인 컨트랙트 배포</a> 와 같이 <code>deploy</code> 커맨드를 사용하여 루트체인 컨트랙트 배포 후 <code>genesis.json</code> 파일을 생성한다.</p>
<blockquote>
<p>해당 genesis.json 파일의 예시는 <a href="https://github.com/Onther-Tech/plasma-evm-networks/blob/master/faraday-testnet/faraday.json">faraday.json</a> 에서 확인할 수 있다.</p>
</blockquote>
<p>아래 커맨드로 <code>deploy.rootchain.sh</code> 스크립트 파일을 생성한다.</p>
<pre><code class="hljs css language-bash">plasma-evm$ tee deploy.rootchain.sh &lt;&lt;<span class="hljs-string">'EOF'</span>
<span class="hljs-meta">#!/bin/bash
</span>
OPERATOR_KEY=<span class="hljs-string">"b71c71a67e1177ad4e901695e1b4b9ee17ae16c6668d313eac2f96dbcda3f291"</span>
KEY2=<span class="hljs-string">"78ae75d1cd5960d87e76a69760cb451a58928eee7890780c352186d23094a115"</span>
KEY3=<span class="hljs-string">"067394195895a82e685b000e592f771f7899d77e87cc8c79110e53a2f0b0b8fc"</span>
KEY4=<span class="hljs-string">"ae03e057a5b117295db86079ba4c8505df6074cdc54eec62f2050e677e5d4e66"</span>
KEY5=<span class="hljs-string">"eda4515e1bc6c08e8606b51ffb6ffe70b3fe76781ed49872285e484064e3b634"</span>
CHALLENGER_KEY=<span class="hljs-string">"78ae75d1cd5960d87e76a69760cb451a58928eee7890780c352186d23094a114"</span>

DATADIR=pls.data
OPERATOR=<span class="hljs-string">"0x71562b71999873DB5b286dF957af199Ec94617F7"</span>
CHALLENGER=<span class="hljs-string">"0x3616BE06D68dD22886505e9c2CaAa9EcA84564b8"</span>

ROOTCHAIN_IP=localhost <span class="hljs-comment"># Onther Ropsten Geth Node IP.</span>

<span class="hljs-comment"># Deploy contracts at rootchain</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Deploy rootchain contract and others"</span>
make geth &amp;&amp; build/bin/geth --nousb \
    --rootchain.url <span class="hljs-string">"ws://<span class="hljs-variable">$ROOTCHAIN_IP</span>:8546"</span> \
    --operator.key <span class="hljs-variable">$OPERATOR_KEY</span> \
    --datadir <span class="hljs-variable">$DATADIR</span> \
    deploy <span class="hljs-string">"./genesis.json"</span> 16 <span class="hljs-literal">true</span> 4096

<span class="hljs-comment"># deploy params : chainID, isInitialAsset, Epochlength</span>
<span class="hljs-comment"># you can checkout "$geth deploy --help" for more information</span>
EOF
</code></pre>
<p>아래 명령어로 <code>deploy.rootchain.sh</code> 실행한다.</p>
<pre><code class="hljs css language-bash">plasma-evm$ bash deploy.rootchain.sh
</code></pre>
<p>생성된 <code>genesis.json</code> 파일은 <code>plasma-evm</code> 폴더에 위치한다.</p>
<h2><a class="anchor" aria-hidden="true" id="puppeth-실행-및-설정"></a><a href="#puppeth-실행-및-설정" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Puppeth 실행 및 설정</h2>
<h3><a class="anchor" aria-hidden="true" id="1-puppeth-실행"></a><a href="#1-puppeth-실행" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. <code>Puppeth</code> 실행</h3>
<p><code>build/bin/puppeth</code> 명령어로 <code>puppeth</code>를 실행한다.</p>
<pre><code class="hljs css language-text">plasma-evm$ build/bin/puppeth
+-----------------------------------------------------------+
| Welcome to puppeth, your Ethereum private network manager |
|                                                           |
| This tool lets you create a new Ethereum network down to  |
| the genesis block, bootnodes, miners and ethstats servers |
| without the hassle that it would normally entail.         |
|                                                           |
| Puppeth uses SSH to dial in to remote servers, and builds |
| its network components out of Docker containers using the |
| docker-compose toolset.                                   |
+-----------------------------------------------------------+

Please specify a network name to administer (no spaces, hyphens or capital letters please)
>
</code></pre>
<p>자신이 정하고 싶은 임의의 <code>NETWORK NAME</code>을 입력한다.
입력한 <code>NETWORK NAME</code> 은 <code>Puppeth</code>가 네트워크를 식별하기 위해 <code>~/.puppeth/&lt;NETWORK NAME&gt;</code> 파일로 저장된다.</p>
<blockquote>
<p><code>Puppeth</code>를 시작할때 이전에 사용한 <code>NETWORK NAME</code>을 입력하면 저장된 설정 값이 적용된다.</p>
</blockquote>
<p>아래 <a href="how-to-open-private-testnet-puppeth">사용자 노드</a>와 <a href="(how-to-open-private-testnet-puppeth#오퍼레이터-노드-설정)">오퍼레이터 노드 설정</a> 과정은 <code>puppeth</code> 실행화면에서 작업을 수행한다.</p>
<h3><a class="anchor" aria-hidden="true" id="2-genesis-파일-설정"></a><a href="#2-genesis-파일-설정" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. <code>genesis</code> 파일 설정</h3>
<p><code>Puppeth</code>를 이용해 노드들을 설정하기 위해서 <a href="how-to-open-private-testnet-puppeth#2--루트체인-컨트랙트-배포">Puppeth 준비 - 2. 루트체인 컨트랙트 배포</a>를 통해 생성한 <code>genesis.json</code> 파일이 필요하다.</p>
<pre><code class="hljs css language-text">What would you like to do? (default = stats)
    1. Show network stats
    2. Configure new genesis
    3. Track new remote server
    4. Deploy network components
> 2

What would you like to do? (default = create)
    1. Create new genesis from scratch
    2. Import already existing genesis
> 2

Where's the genesis file? (local file or http/https url)
> /home/ubuntu/plasma-evm/genesis.json
</code></pre>
<p><code>genesis.json</code> 파일이 제대로 임포트(import) 되는 경우 아래와 같은 메시지가 출력되고 초기 선택화면으로 돌아간다.</p>
<pre><code class="hljs css language-text">INFO [12-12|05:45:32.124] Imported genesis block
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="3-리모트-머신-추가"></a><a href="#3-리모트-머신-추가" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 리모트 머신 추가</h3>
<p>만약 MacOS 환경에 설치하고자 한다면, MacOS 운영체제 원격 로그인을 허용해야 한다.
이부분은 apple에서 제공하는 <a href="https://support.apple.com/ko-kr/guide/mac-help/mchlp1066/mac">macOS 사용 설명서 - Mac에서 원격 로그인 설정하기</a> 부분을 참고한다.</p>
<p><code>Puppeth</code> 화면에서 로컬 환경을 리모트 머신으로서 추가한다.</p>
<pre><code class="hljs css language-text">What would you like to do? (default = stats)
    1. Show network stats
    2. Configure new genesis
    3. Track new remote server
    4. Deploy network components
> 3

What is the remote server's address ([username[:identity]@]hostname[:port])?
> ubuntu@<Public IP address>

</code></pre>
<blockquote>
<p>해당 주소를 통해 각 노드의 IP주소를 참고하기 때문에, 원격 접속 주소 사용시 <code>localhost(=127.0.0.1)</code> 사용하면 안된다.
가급적 공인 IP(Public IP)를 사용한다.</p>
</blockquote>
<pre><code class="hljs css language-text">The authenticity of host '52.198.169.75:22 (52.198.169.75:22)' can't be established.
SSH key fingerprint is ff:00:ff:00:ff:00:ff:00:ff:00:ff:00:ff:00:ff:00 [MD5]
Are you sure you want to continue connecting (yes/no)? yes

INFO [02-25|00:00:00.000] Starting remote server health-check      server=ubuntu@52.198.169.75
+----------------------+---------------+---------+--------+-------+
|        SERVER        |    ADDRESS    | SERVICE | CONFIG | VALUE |
+----------------------+---------------+---------+--------+-------+
| ubuntu@52.198.169.75 | 52.198.169.75 |         |        |       |
+----------------------+---------------+---------+--------+-------+
</code></pre>
<blockquote>
<p>IP 주소 대신 도메인(Domain) 주소를 입력하는 경우, 리버스 프록시(Reverse Proxy) 서버로 사용되는 <code>Nginx</code>가 도메인 구문을 파싱하지 못한다. 따라서 IP 주소를 직접 넣어준다.</p>
</blockquote>
<p>SSH키 파일을 사용하는경우 <code>onther:onther_private.pem@localhost</code> 와 같은 형태로 입력한다.</p>
<h2><a class="anchor" aria-hidden="true" id="노드-컨테이너-배포"></a><a href="#노드-컨테이너-배포" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>노드 컨테이너 배포</h2>
<h3><a class="anchor" aria-hidden="true" id="1-ethstats-컨테이터-배포"></a><a href="#1-ethstats-컨테이터-배포" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. <code>Ethstats</code> 컨테이터 배포</h3>
<p><code>Puppeth</code>는 <code>ethstats</code>에 관한 정보가 없는 경우 실행 되지 않는다. 따라서 <code>ethstats</code> 노드를 먼저 배포해야 한다.</p>
<pre><code class="hljs css language-text">+----------------------+---------------+---------+--------+-------+
|        SERVER        |    ADDRESS    | SERVICE | CONFIG | VALUE |
+----------------------+---------------+---------+--------+-------+
| ubuntu@52.198.169.75 | 52.198.169.75 |         |        |       |
+----------------------+---------------+---------+--------+-------+

What would you like to do? (default = stats)
    1. Show network stats
    2. Manage existing genesis
    3. Manage tracked machines
    4. Deploy network components
> 4

What would you like to deploy? (recommended order)
    1. Ethstats  - Network monitoring tool
    2. Bootnode  - Entry point of the network
    3. Sealer    - Full node minting new blocks
    4. Explorer  - Chain analysis webservice
    5. Wallet    - Browser wallet for quick sends
    6. Faucet    - Crypto faucet to give away funds
    7. Dashboard - Website listing above web-services
> 1

Which server do you want to interact with?
    1. onther@localhost
    2. Connect another server
> 1

Which port should ethstats listen on? (default = 80)
> 80

Allow sharing the port with other services (y/n)? (default = yes)
> y

INFO [01-01|00:00:00.000] Deploying nginx reverse-proxy            server=localhost port=80
Building nginx
Step 1/1 : FROM jwilder/nginx-proxy
    ---> 46fc9150cb48
Successfully built 46fc9150cb48
Successfully tagged faraday/nginx:latest
Creating faraday_nginx_1 ...
Creating faraday_nginx_1 ... done
</code></pre>
<p><code>Ethstats</code> 서버 연결을 위한 리버스 프록시가 먼저 구성된다. 계속해서 <code>Ethstats</code> 컨테이너를 생성하기 위해 도메인 주소(또는 IP 주소)와 비밀번호를 입력해준다.</p>
<pre><code class="hljs css language-text">Proxy deployed, which domain to assign? (default = localhost)
> 52.198.169.75
What should be the secret password for the API? (must not be empty)
> onther

Found orphan containers (faraday_nginx_1) for this project. If you removed or renamed this service in your compose file, you can run this command with the --remove-orphans flag to clean it up.
Building ethstats
Step 1/2 : FROM puppeth/ethstats:latest
    ---> fb62abe59cb2
Step 2/2 : RUN echo 'module.exports = {trusted: [], banned: [], reserved: ["yournode"]};' > lib/utils/config.js
    ---> Running in ac7e749c51f5
Removing intermediate container ac7e749c51f5
    ---> 276dd2683d00
Successfully built 276dd2683d00
Successfully tagged faraday/ethstats:latest
Creating faraday_ethstats_1 ...
Creating faraday_ethstats_1 ... done
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="2-사용자-노드-컨테이너-배포"></a><a href="#2-사용자-노드-컨테이너-배포" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 사용자 노드 컨테이너 배포</h3>
<p><code>Ethstats</code> 정보가 있어야 사용자 노드 컨테이너 생성이 가능하다. 따라서, <a href="how-to-open-private-testnet-puppeth#3-ethstats-컨테이터-배포">3. Ethstats 컨테이터 배포</a>를 반드시 먼저 수행한다.</p>
<pre><code class="hljs css language-text">+----------------------+---------------+----------+-----------------------+---------------+
|        SERVER        |    ADDRESS    | SERVICE  |        CONFIG         |     VALUE     |
+----------------------+---------------+----------+-----------------------+---------------+
| ubuntu@52.198.169.75 | 52.198.169.75 | ethstats | Banned addresses      |               |
|                      |               |          | Login secret          | onther        |
|                      |               |          | Website address       | 52.198.169.75 |
|                      |               |          | Website listener port | 80            |
|                      |               |          | --------------------- | ------------- |
|                      |               | nginx    | Shared listener port  | 80            |
+----------------------+---------------+----------+-----------------------+---------------+

What would you like to do? (default = stats)
    1. Show network stats
    2. Manage existing genesis
    3. Manage tracked machines
    4. Deploy network components
> 4

    1. Tear down Nginx on ubuntu@localhost
    2. Tear down Ethstats on ubuntu@localhost
    3. Deploy new network component
> 3

What would you like to deploy? (recommended order)
    1. Ethstats  - Network monitoring tool
    2. Bootnode  - Entry point of the network
    3. Sealer    - Full node minting new blocks
    4. Explorer  - Chain analysis webservice
    5. Wallet    - Browser wallet for quick sends
    6. Faucet    - Crypto faucet to give away funds
    7. Dashboard - Website listing above web-services
> 2

Which server do you want to interact with?
    1. ubuntu@52.198.169.75
    2. Connect another server
> 1

What URL to listen on root chain JSONRPC?
> ws://172.17.0.1:8546
</code></pre>
<p>AWS와 같은 원격 호스트에서 <code>rootchain</code>이 작동중이라면, <code>Docker bridge network</code>의 IP 주소를 적어준다.(기본값 172.17.0.1)</p>
<p>만약, 생성된 <code>bootnode</code> 컨테이너가 rootchain 주소를 못찾는 경우 아래 명령어를 통해서 호스트 머신의 IP들 중 하나를 사용한다.</p>
<pre><code class="hljs css language-bash">~$ ifconfig | grep <span class="hljs-string">"inet "</span>
    inet 172.17.0.1  netmask 255.255.0.0  broadcast 172.17.255.255
    inet 172.18.0.1  netmask 255.255.0.0  broadcast 172.18.255.255
    inet 172.31.9.133  netmask 255.255.240.0  broadcast 172.31.15.255
    inet 127.0.0.1  netmask 255.0.0.0
</code></pre>
<blockquote>
<p><code>127.0.0.1</code> 를 사용하는 경우, usernode 자신을 네트워크를 보게 되므로 호스트에서 동작중인 rootchain에 접속이 불가능하다.</p>
</blockquote>
<p><code>What URL to listen on root chain JSONRPC</code>에 입력 값으로 루트체인 웹소켓(websocket) 주소를 적어준다.( e.g <code>ws://172.17.0.1:8546</code>)</p>
<pre><code class="hljs css language-text">Do you want expose HTTP JSONRPC endpoint (y/n)? (default=no)
> y

Which TCP port to expose? (default=8545)
> 8547

Which is virtual hostname? (default=172.17.0.1,localhost)
> 172.17.0.1
</code></pre>
<p>사용자가 해당 노드에 접근하도록 <code>HTTP JSONRPC endpoint</code> 콘솔에 <code>yes</code>를 입력 한다.</p>
<pre><code class="hljs"><span class="hljs-keyword">Do</span> you want expose WebSocket JSONRPC endpoint (y/n)? (<span class="hljs-attribute">default</span>=<span class="hljs-literal">no</span>)
&gt; y

Which TCP<span class="hljs-built_in"> port </span><span class="hljs-keyword">to</span> expose? (<span class="hljs-attribute">default</span>=8546)
&gt; 8548

Where should data be stored on the remote machine?
&gt; /home/ubuntu/.pls.user

Which TCP/UDP<span class="hljs-built_in"> port </span><span class="hljs-keyword">to</span> listen on? (default = 30305)
&gt; 30306

How many peers <span class="hljs-keyword">to</span> allow connecting? (default = 512)
&gt; 512

How many light peers <span class="hljs-keyword">to</span> allow connecting? (default = 256)
&gt; 256

What should the node be called on the stats page?
&gt; usernode

Building bootnode
<span class="hljs-keyword">Step</span> 1/4 : <span class="hljs-keyword">FROM</span> onthertech/plasma-evm:latest
latest: Pulling <span class="hljs-keyword">from</span> onthertech/plasma-evm
Digest: sha256:aa8029de17fb3da6c390545df4e05abae109ec6a45f12ecb22a0e0063b1aa276
Status: Downloaded newer image <span class="hljs-keyword">for</span> onthertech/plasma-evm:latest
    ---&gt; 1576e54d80ef
<span class="hljs-keyword">Step</span> 2/4 : <span class="hljs-builtin-name">ADD</span> genesis.json /genesis.json
    ---&gt; 5c5992d4f1a2
<span class="hljs-keyword">Step</span> 3/4 : <span class="hljs-builtin-name">RUN</span>   echo $<span class="hljs-string">'geth --cache 512 init --rootchain.url ws://172.17.0.1:8546 /genesis.json'</span> &gt; geth.sh &amp;&amp;  echo $<span class="hljs-string">'exec geth --syncmode="full" --networkid 16 --rootchain.url ws://172.17.0.1:8546 --rpc --rpcaddr \'</span>0.0.0.0\<span class="hljs-string">' --rpcport 8545 --rpcapi eth,net,debug --rpccorsdomain "*" --rpcvhosts=localhost --ws --wsorigins \'</span>*\<span class="hljs-string">' --wsaddr \'</span>0.0.0.0\<span class="hljs-string">' --wsport 8546 --cache 512 --port 30306 --nat extip:52.198.169.75 --maxpeers 512 --lightpeers=256 --lightserv=50 --ethstats \'</span>tokamak-mynode:ubuntu@localhost\<span class="hljs-string">'    --miner.gastarget 0 --miner.gaslimit 0 --miner.gasprice 0'</span> &gt;&gt; geth.sh
    ---&gt; Running <span class="hljs-keyword">in</span> 826cf2fe881a
Removing intermediate container 826cf2fe881a
    ---&gt; ed4330e0d27f
<span class="hljs-keyword">Step</span> 4/4 : ENTRYPOINT [<span class="hljs-string">"/bin/sh"</span>, <span class="hljs-string">"geth.sh"</span>]
    ---&gt; Running <span class="hljs-keyword">in</span> 49f1003114a2
Removing intermediate container 49f1003114a2
    ---&gt; 120072c6f2ee
Successfully built 120072c6f2ee
Successfully tagged tokamak/bootnode:latest
Creating tokamak_bootnode_1 <span class="hljs-built_in">..</span>.
Creating tokamak_bootnode_1 <span class="hljs-built_in">..</span>. done
</code></pre>
<p>나머지는 기본값을 입력하고, <code>Ethstats</code>에서 보여질 사용자 노드의 이름으로 <code>usernode</code>로 입력한다.</p>
<h3><a class="anchor" aria-hidden="true" id="3-오퍼레이터-노드-설정"></a><a href="#3-오퍼레이터-노드-설정" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 오퍼레이터 노드 설정</h3>
<p>자식체인의 블록을 생성하는 오퍼레이터 노드를 설정한다. <code>Puppeth</code>를 사용하여 오퍼레이터 노드 설정하기 이전에 <code>Ethstats</code>과 사용자 노드(=<code>bootnode</code>)가 미리 구성되어 있어야 한다.</p>
<pre><code class="hljs css language-text">+----------------------+---------------+----------+--------------------------+--------------------------+
|       SERVER         |    ADDRESS    | SERVICE  |          CONFIG          |          VALUE           |
+----------------------+---------------+----------+--------------------------+--------------------------+
| ubuntu@52.198.169.75 | 52.198.169.75 | bootnode | Data directory           | /home/ubuntu/.pls.user   |
|                      |               |          | Ethstats username        | usernode                 |
|                      |               |          | JSONRPC VHOST            | 52.198.169.75,localhost  |
|                      |               |          | Listener port            | 30306                    |
|                      |               |          | Peer count (all total)   | 512                      |
|                      |               |          | Peer count (light nodes) | 256                      |
|                      |               |          | Root chain JSONRPC URL   | ws://172.17.0.1:8546     |
|                      |               |          | ------------------------ | ------------------------ |
|                      |               | ethstats | Banned addresses         |                          |
|                      |               |          | Login secret             | onther                   |
|                      |               |          | Website address          | 52.198.169.75            |
|                      |               |          | Website listener port    | 80                       |
|                      |               |          | ------------------------ | ------------------------ |
|                      |               | nginx    | Shared listener port     | 80                       |
+----------------------+---------------+----------+--------------------------+--------------------------+

What would you like to do? (default = stats)
1. Show network stats
2. Manage existing genesis
3. Manage tracked machines
4. Deploy network components
> 4

 1. Tear down Nginx on ubuntu@localhost
 2. Tear down Ethstats on ubuntu@localhost
 3. Tear down Bootnode on ubuntu@localhost
 4. Deploy new network component
> 4

What would you like to deploy? (recommended order)
1. Ethstats  - Network monitoring tool
2. Bootnode  - Entry point of the network
3. Sealer    - Full node minting new blocks
4. Explorer  - Chain analysis webservice
5. Wallet    - Browser wallet for quick sends
6. Faucet    - Crypto faucet to give away funds
7. Dashboard - Website listing above web-services
> 3

Which server do you want to interact with?
1. ubuntu@52.198.169.75
2. Connect another server
> 1

What URL to listen on root chain JSONRPC?
> ws://172.17.0.1:8546
</code></pre>
<p>사용자 노드와 동일한 루트체인 웹소켓(websocket) 주소를 입력한다.</p>
<pre><code class="hljs css language-text">Do you want expose HTTP JSONRPC endpoint (y/n)? (default=no)
> n

Do you want expose WebSocket JSONRPC endpoint (y/n)? (default=no)
> n

Where should data be stored on the remote machine?
> /home/ubuntu/.pls.oper

Where should the ethash mining DAGs be stored on the remote machine?
> /home/ubuntu/.pls.dag

</code></pre>
<p><code>~ be stored on the remote machine?</code> 에서 입력하는 디렉토리 주소는 <code>Docker</code> 컨테이너와 호스트가 공유하는 디렉토리로, 호스트 머신에서 접근이 가능하다.</p>
<pre><code class="hljs">
Which TCP/UDP port <span class="hljs-keyword">to</span> listen <span class="hljs-keyword">on</span>? (<span class="hljs-keyword">default</span> = <span class="hljs-number">30305</span>)
&gt; <span class="hljs-number">30307</span>

How many peers <span class="hljs-keyword">to</span> allow connecting? (<span class="hljs-keyword">default</span> = <span class="hljs-number">50</span>)
&gt; <span class="hljs-number">50</span>

How many light peers <span class="hljs-keyword">to</span> allow connecting? (<span class="hljs-keyword">default</span> = <span class="hljs-number">0</span>)
&gt; <span class="hljs-number">0</span>

What should the node be called <span class="hljs-keyword">on</span> the stats page?
&gt; operator

Please paste the operator<span class="hljs-comment">'s key JSON:</span>
&gt; {<span class="hljs-string">"address"</span>:<span class="hljs-string">"71562b71999873db5b286df957af199ec94617f7"</span>,<span class="hljs-string">"crypto"</span>:{<span class="hljs-string">"cipher"</span>:<span class="hljs-string">"aes-128-ctr"</span>,<span class="hljs-string">"ciphertext"</span>:<span class="hljs-string">"8b750c93fdecb295568a3a8f73531d2ce019393a65328de204bbdcae93ee7ba5"</span>,<span class="hljs-string">"cipherparams"</span>:{<span class="hljs-string">"iv"</span>:<span class="hljs-string">"1c09cf80049e26f45d06f6d659df5194"</span>},<span class="hljs-string">"kdf"</span>:<span class="hljs-string">"scrypt"</span>,<span class="hljs-string">"kdfparams"</span>:{<span class="hljs-string">"dklen"</span>:<span class="hljs-number">32</span>,<span class="hljs-string">"n"</span>:<span class="hljs-number">262144</span>,<span class="hljs-string">"p"</span>:<span class="hljs-number">1</span>,<span class="hljs-string">"r"</span>:<span class="hljs-number">8</span>,<span class="hljs-string">"salt"</span>:<span class="hljs-string">"9eb4b1b5b1374d977fec0754eac926fde62723b5ce2dd304b707db034199007f"</span>},<span class="hljs-string">"mac"</span>:<span class="hljs-string">"42e15aa26aa6bb3e274c518530f75f02d385cb4706bc639a95913a4f33134eb8"</span>},<span class="hljs-string">"id"</span>:<span class="hljs-string">"8be79bc9-06ea-4328-8d9c-89440f19a25d"</span>,<span class="hljs-string">"version"</span>:<span class="hljs-number">3</span>}

What<span class="hljs-comment">'s the unlock password for the account? (won't be echoed)</span>
&gt;

Please paste the challenger<span class="hljs-comment">'s key JSON:</span>
&gt; {<span class="hljs-string">"address"</span>:<span class="hljs-string">"3616be06d68dd22886505e9c2caaa9eca84564b8"</span>,<span class="hljs-string">"crypto"</span>:{<span class="hljs-string">"cipher"</span>:<span class="hljs-string">"aes-128-ctr"</span>,<span class="hljs-string">"ciphertext"</span>:<span class="hljs-string">"58a35baf690ae21cd25af78141adf8282f731e5ac287e4e8703112e59484d0a4"</span>,<span class="hljs-string">"cipherparams"</span>:{<span class="hljs-string">"iv"</span>:<span class="hljs-string">"1664f876800c39715641de011b6c7193"</span>},<span class="hljs-string">"kdf"</span>:<span class="hljs-string">"scrypt"</span>,<span class="hljs-string">"kdfparams"</span>:{<span class="hljs-string">"dklen"</span>:<span class="hljs-number">32</span>,<span class="hljs-string">"n"</span>:<span class="hljs-number">262144</span>,<span class="hljs-string">"p"</span>:<span class="hljs-number">1</span>,<span class="hljs-string">"r"</span>:<span class="hljs-number">8</span>,<span class="hljs-string">"salt"</span>:<span class="hljs-string">"9609b8b7c9f5082120306fdb0e7c69973869da60a7989a3f049e4cb93aa9871f"</span>},<span class="hljs-string">"mac"</span>:<span class="hljs-string">"cfbd7959e0bc5a19493a8413f30a8ff450e4a28caff60d389df6718b17c8abaf"</span>},<span class="hljs-string">"id"</span>:<span class="hljs-string">"1d9853e8-9478-4390-8f5c-f8d10447f749"</span>,<span class="hljs-string">"version"</span>:<span class="hljs-number">3</span>}

What<span class="hljs-comment">'s the unlock password for the account? (won't be echoed)</span>
&gt;
</code></pre>
<p>오퍼레이터와 챌린저 계정은 루트체인에 잔고(Balance)가 있는 계정을 사용해야 한다.</p>
<pre><code class="hljs">What gas limit should empty blocks target (MGas)? (<span class="hljs-section">default</span> = <span class="hljs-number">7.500</span>)
&gt; <span class="hljs-number">7.5</span>

What gas limit should full blocks target (MGas)? (<span class="hljs-section">default</span> = <span class="hljs-number">10.000</span>)
&gt; <span class="hljs-number">10</span>

What gas price should the operator require (GWei)? (<span class="hljs-section">default</span> = <span class="hljs-number">1.000</span>)
&gt; <span class="hljs-number">1</span>
</code></pre>
<p>나머지는 기본값을 사용한다.</p>
<blockquote>
<p><code>What gas limit should full blocks target?</code>의 값를 높여 오퍼레이터 노드가 생성하는 블록에서 더 많은 트랜잭션을 처리 할 수 있도록 한다.</p>
</blockquote>
<pre><code class="hljs">Building sealnode
Step 1/7 : FROM onthertech/plasma-evm<span class="hljs-function">:latest</span>
latest: Pulling from onthertech/plasma-evm
Digest: sha256<span class="hljs-function">:aa8029de17fb3da6c390545df4e05abae109ec6a45f12ecb22a0e0063b1aa276</span>
Status: Downloaded newer image for onthertech/plasma-evm<span class="hljs-function">:latest</span>
<span class="hljs-params">---</span>&gt; 1576e54d80ef
Step 2/7 : ADD genesis.json <span class="hljs-string">/genesis.json</span>
<span class="hljs-params">---</span>&gt; 1087509c762e
Step 3/7 : ADD operator.json <span class="hljs-string">/operator.json</span>
<span class="hljs-params">---</span>&gt; 714dd1c15216
Step 4/7 : ADD challenger.json <span class="hljs-string">/challenger.json</span>
<span class="hljs-params">---</span>&gt; b03d83cf4459
Step 5/7 : ADD signer.pass <span class="hljs-string">/signer.pass</span>
<span class="hljs-params">---</span>&gt; 2ba822bdd81b
Step 6/7 : RUN   <span class="hljs-keyword">echo</span> $'geth <span class="hljs-params">--cache</span> 512 init <span class="hljs-params">--rootchain</span>.url ws:<span class="hljs-string">//172.17.0.1</span><span class="hljs-function">:8546</span> <span class="hljs-string">/genesis.json</span>' &gt; geth.sh &amp;&amp;  <span class="hljs-keyword">echo</span> 'mkdir -p <span class="hljs-string">/root/.ethereum/keystore/</span>' &gt;&gt; geth.sh &amp;&amp;   <span class="hljs-keyword">echo</span> 'cp <span class="hljs-string">/operator.json</span> <span class="hljs-string">/root/.ethereum/keystore/</span>' &gt;&gt; geth.sh &amp;&amp;  <span class="hljs-keyword">echo</span> 'cp <span class="hljs-string">/challenger.json</span> <span class="hljs-string">/root/.ethereum/keystore/</span>' &gt;&gt; geth.sh &amp;&amp;  <span class="hljs-keyword">echo</span> $'exec geth <span class="hljs-params">--syncmode=</span><span class="hljs-string">"full"</span> <span class="hljs-params">--networkid</span> 16 <span class="hljs-params">--rootchain</span>.url ws:<span class="hljs-string">//172.17.0.1</span><span class="hljs-function">:8546</span> <span class="hljs-params">--operator</span> 0x71562b71999873DB5b286dF957af199Ec94617F7 <span class="hljs-params">--rootchain</span>.challenger 0x3616BE06D68dD22886505e9c2CaAa9EcA84564b8   <span class="hljs-params">--cache</span> 512 <span class="hljs-params">--port</span> 30305 <span class="hljs-params">--nat</span> extip<span class="hljs-function">:52.198.169.75</span> <span class="hljs-params">--maxpeers</span> 50  <span class="hljs-params">--ethstats</span> \'tokamak-operator<span class="hljs-function">:ubuntu</span>@52.198.169.75'   <span class="hljs-params">--unlock</span> 0x71562b71999873DB5b286dF957af199Ec94617F7,0x3616BE06D68dD22886505e9c2CaAa9EcA84564b8 <span class="hljs-params">--password</span> <span class="hljs-string">/signer.pass</span> <span class="hljs-params">--mine</span> <span class="hljs-params">--miner</span>.gastarget 7500000 <span class="hljs-params">--miner</span>.gaslimit 10000000 <span class="hljs-params">--miner</span>.gasprice 1000000000' &gt;&gt; geth.sh
<span class="hljs-params">---</span>&gt; Running in 9d7f43a35d30
Removing intermediate container 9d7f43a35d30
<span class="hljs-params">---</span>&gt; 30948ea415b2
Step 7/7 : ENTRYPOINT [<span class="hljs-string">"/bin/sh"</span>, <span class="hljs-string">"geth.sh"</span>]
<span class="hljs-params">---</span>&gt; Running in aba79252703b
Removing intermediate container aba79252703b
<span class="hljs-params">---</span>&gt; 0c3f6aa8d7ed
Successfully built 0c3f6aa8d7ed
Successfully tagged tokamak/sealnode<span class="hljs-function">:latest</span>
Creating tokamak_sealnode_1 <span class="hljs-string">...</span>
Creating tokamak_sealnode_1 <span class="hljs-string">...</span> done
</code></pre>
<p>오퍼레이터 노드가 정상적으로 배포되는 경우 위와 같은 결과가 출력된다.</p>
<h3><a class="anchor" aria-hidden="true" id="배포한-컨테이너-확인"></a><a href="#배포한-컨테이너-확인" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>배포한 컨테이너 확인</h3>
<p><code>Puppeth</code>를 통해 <code>Ethstats</code>, <code>Bootnode</code>, <code>Nginx</code> 그리고 <code>Sealnode</code> 컨테이너가 생성되었다.</p>
<p><code>Puppeth</code>에서의 컨테이너 조회 결과는 다음과 같다.</p>
<pre><code class="hljs css language-text">+----------------------+---------------+----------+------------------------------+----------------------------------------------+
|        SERVER        |    ADDRESS    | SERVICE  |            CONFIG            |                     VALUE                    |
+----------------------+---------------+----------+------------------------------+----------------------------------------------+
| ubuntu@52.198.169.75 | 52.198.169.75 | bootnode | Data directory               | /home/ubuntu/.pls.user                       |
|                      |               |          | Ethstats username            | usernode                                     |
|                      |               |          | JSONRPC VHOST                | 52.198.169.75,localhost                      |
|                      |               |          | Listener port                | 30306                                        |
|                      |               |          | Peer count (all total)       | 512                                          |
|                      |               |          | Peer count (light nodes)     | 256                                          |
|                      |               |          | Root chain JSONRPC URL       | ws://172.17.0.1:8546                         |
|                      |               |          | ---------------------------- | -------------------------------------------- |
|                      |               | ethstats | Banned addresses             |                                              |
|                      |               |          | Login secret                 | onther                                       |
|                      |               |          | Website address              | 52.198.169.75                                |
|                      |               |          | Website listener port        | 80                                           |
|                      |               |          | ---------------------------- | -------------------------------------------- |
|                      |               | nginx    | Shared listener port         | 80                                           |
|                      |               |          | ---------------------------- | -------------------------------------------- |
|                      |               | sealnode | CHallenger account           | 0x3616BE06D68dD22886505e9c2CaAa9EcA84564b8   |
|                      |               |          | Data directory               | /home/ubuntu/.pls.oper                       |
|                      |               |          | Ethstats username            | operator                                     |
|                      |               |          | Gas ceil  (target maximum)   | 10.000 MGas                                  |
|                      |               |          | Gas floor (baseline target)  | 7.500 MGas                                   |
|                      |               |          | Gas price (minimum accepted) | 1.000 GWei                                   |
|                      |               |          | Listener port                | 30307                                        |
|                      |               |          | Operator account             | 0x71562b71999873DB5b286dF957af199Ec94617F7   |
|                      |               |          | Peer count (all total)       | 50                                           |
|                      |               |          | Peer count (light nodes)     | 0                                            |
|                      |               |          | Root chain JSONRPC URL       | ws://172.17.0.1:8546                         |
+----------------------+---------------+----------+------------------------------+----------------------------------------------+
</code></pre>
<p><img src="/docs/assets/guides_private_testnet_puppeth.png" alt="Plasma-evm Private Testnet Architecture"></p>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 2020-3-9 by Jin</em></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/ko/guides/getting-started/how-to-open-private-testnet-manually"><span class="arrow-prev">← </span><span>자식체인 설정</span></a><a class="docs-next button" href="/docs/ko/guides/getting-started/how-to-connect-public-testnet-prepare"><span>연결 준비</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#puppeth-환경-준비"><code>Puppeth</code> 환경 준비</a><ul class="toc-headings"><li><a href="#1-네트워크-설정">1. 네트워크 설정</a></li><li><a href="#2-docker--docker-compose-설정">2. Docker &amp; Docker compose 설정</a></li><li><a href="#3-원격-접속-키파일-등록">3. 원격 접속 키파일 등록</a></li><li><a href="#4-소스코드-다운로드-및-컴파일">4. 소스코드 다운로드 및 컴파일</a></li><li><a href="#5--루트체인-컨트랙트-배포">5.  루트체인 컨트랙트 배포</a></li></ul></li><li><a href="#puppeth-실행-및-설정">Puppeth 실행 및 설정</a><ul class="toc-headings"><li><a href="#1-puppeth-실행">1. <code>Puppeth</code> 실행</a></li><li><a href="#2-genesis-파일-설정">2. <code>genesis</code> 파일 설정</a></li><li><a href="#3-리모트-머신-추가">3. 리모트 머신 추가</a></li></ul></li><li><a href="#노드-컨테이너-배포">노드 컨테이너 배포</a><ul class="toc-headings"><li><a href="#1-ethstats-컨테이터-배포">1. <code>Ethstats</code> 컨테이터 배포</a></li><li><a href="#2-사용자-노드-컨테이너-배포">2. 사용자 노드 컨테이너 배포</a></li><li><a href="#3-오퍼레이터-노드-설정">3. 오퍼레이터 노드 설정</a></li><li><a href="#배포한-컨테이너-확인">배포한 컨테이너 확인</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"></a><div><h5>Docs</h5><a href="/docs/ko/learn/basic/tokamak-network">Learn</a><a href="/docs/ko/guides/getting-started/how-to-open-private-testnet-rootchain">Guides</a></div><div><h5>Community</h5><a href="https://discord.gg/8wSpJKz">Discord</a><a href="https://t.me/tokamak_network">Telegram</a><a href="https://twitter.com/ontherinfo">Twitter</a><a href="https://www.facebook.com/OntherInc">Facebook</a></div><div><h5>More</h5><a href="http://blog.onther.io">Onther Blog</a><a href="https://github.com/onther-tech/">Onther GitHub</a></div></section><a href="https://tokamak.network" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/img/tokamak_white.png" alt="Tokamak Network" width="200%" height="200%"/></a><section class="copyright">Copyright © 2020 Onther Inc.</section></footer></div></body></html>